[toc]

# CRF -- 条件随机场

## 阅读提示

**阅读提示**：先看这些文章！[这一系列文章很好！](https://www.cnblogs.com/baiboy/p/crf2.html)，有深度，而且结合了具体例子再讲，这些看完以后，这个[NLP —— 图模型（二）条件随机场（Conditional random field，CRF）](https://www.cnblogs.com/Determined22/p/6915730.html)作为补充，同时结合自己总结的HMM看，以下为简单的肤浅总结：

## 1. 关键字

* 特征方程：对于词性标注来说，输入通常是一个句子，词在句子中的位置，当前词的标签，上一个词的标签，输出通常为0或1

* 线性CRF：只考虑前一个词对当前的影响

* 从特征到概率：给句子的词性标注打分。

![img](..\img\CRF.png)

​		然后归一化，产生概率。

## 2. CRF和HMM对比

结合词性标注来说，CRF和HMM（**有一个关键的联合概率公式，涉及到转移概率和发射概率**，因此为判别式模型）对比，CRF更强大，通过设置特定的特征函数（输入通常是一个句子，词在句子中的位置，当前词的标签，上一个词的标签，输出通常为0或1）和权重$\lambda$去表示HMM中的转移概率和发射概率，CRF可以转换成HMM。

其中，权重学习：初始赋一个随机值，用到了梯度上升来使目标函数的值达到最大。

## 3. CRF为什么用到NER上？

因为在NER好设计特征函数（可以简单地理解为规则，比如定义识别人名的规则）。如下为一个特征函数

![img](..\img\CRF2.png)

案例：讲了CRF分词，见课件。



## Reference

[1] 七月在线课件《条件随机场（初学版）》